# категория B: Задачи с контекстом метаданных УТ11

category:
  id: "B"
  name: "Платформенные задачи"
  description: "Задачи, требующие знания метаданных конфигурации УТ11"
  requires_mcp: true

# параметры генерации для этой категории
generation:
  max_tokens: 4096
  model_params:
    claude:
      temperature: 0.0
      runs: 3  # сlaude без seed — указываем явно количество прогонов
    gpt:
      temperature: 0.1
      seeds: [178, 256, 349]  # длина = количество прогонов
    gemini:
      temperature: 0.1
      seeds: [178, 256, 349]

# промпты для агента сбора контекста (agentic context loader)
agent_prompts:
  system: |
    Тебе необходимо изучить метаданные конфигурации для выполнения задачи.
    У тебя есть доступ к MCP серверу 1С с инструментами для работы с метаданными.
    Используй доступные инструменты для исследования конфигурации.
    Стратегия:
    1. Проанализируй задачу — какие данные нужны?
    2. Используй инструменты для поиска и изучения объектов метаданных
    3. Когда понял какие объекты использовать — вызови finish_research
    Будь экономным — не запрашивай лишние объекты!
  
  user_template: |
    Задача:
    {task_prompt}
    
    Изучи метаданные конфигурации и определи какие объекты нужны для решения этой задачи.
    Используй инструменты для исследования, затем вызови finish_research.

# системный промпт для категории B (контекст добавляется динамически)
system_prompt: |
  Разработка для платформы 1С:Предприятие 8.3.
  Конфигурация: Управление торговлей 11 (УТ11).
  КРИТИЧЕСКИ ВАЖНО:
  1. Используйте ТОЛЬКО объекты метаданных через MCP
  2. НЕ выдумывайте несуществующие реквизиты, справочники или регистры
  3. Пишите на встроенном языке 1С (русский синтаксис)
  4. Возвращайте ТОЛЬКО код без пояснений
  5. Код должен быть готов к выполнению

tasks:
  - id: "B1"
    name: "Остатки товара на складе"
    difficulty: "medium"
    prompt: |
      Напишите функцию получения остатка товара на складе.
      
      Параметры:
        - Товар (СправочникСсылка.Номенклатура)
        - Склад (СправочникСсылка.Склады)
      
      Возврат: Число (количество на остатке)
      
      Используйте запрос к регистру накопления.

  - id: "B2"
    name: "Создание документа реализации"
    difficulty: "hard"
    
    prompt: |
      Напишите процедуру создания документа "Реализация товаров и услуг".
      
      Параметры:
        - Контрагент (СправочникСсылка.Контрагенты)
        - МассивТоваров (Массив структур с полями: Номенклатура, Количество, Цена)
      
      Процедура должна:
        1. Создать новый документ
        2. Заполнить шапку (контрагент, дата)
        3. Заполнить табличную часть товарами
        4. Записать документ

  - id: "B3"
    name: "Отчёт по продажам"
    difficulty: "hard"
    prompt: |
      Напишите функцию формирования отчёта по продажам за период.
      
      Параметры:
        - НачалоПериода (Дата)
        - КонецПериода (Дата)
      
      Возврат: ТаблицаЗначений с колонками:
        - Номенклатура
        - Контрагент
        - Количество
        - Сумма
      
      Группировка по номенклатуре и контрагенту.

  - id: "B4"
    name: "Проверка доступности товара"
    difficulty: "medium" 
    prompt: |
      Напишите функцию проверки возможности отгрузки товара.
      
      Параметры:
        - Товар (СправочникСсылка.Номенклатура)
        - Склад (СправочникСсылка.Склады)
        - Количество (Число)
      
      Возврат: Булево (Истина если остаток >= Количество)
    
  - id: "B5"
    name: "Подбор аналогов товара"
    difficulty: "hard"    
    prompt: |
      Напишите функцию подбора товаров из той же группы номенклатуры,
      которые есть в наличии на указанном складе.
      
      Параметры:
        - Товар (СправочникСсылка.Номенклатура) - исходный товар
        - Склад (СправочникСсылка.Склады)
      
      Возврат: Массив структур {Номенклатура, Остаток} для товаров
               из той же группы с остатком > 0
    